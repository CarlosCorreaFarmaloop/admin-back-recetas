service: ${CI_PROJECT_NAME}

provider:
  name: aws
  runtime: ${LAMBDA_RUNTIME}
  region: ${REGION}
  iam:
    role: ${LAMBDA_ROLE_ARN}
  tracing:
    lambda: true

functions:
  main:
    handler: build/handler.handler
    timeout: 30
    environment:
      MONGO_CONNECTION_STRING: ${MONGO_CONNECTION_STRING}
      MONGO_DATA_BASE: ${MONGO_DATA_BASE}
      ENV: ${ENV}
      TZ: ${TZ}
      SECRET_KEY: ${SECRET_KEY}
      FORCE_FAIL: ${FORCE_FAIL}
    vpc:
      securityGroupIds:
        - ${LAMBDA_SG}
      subnetIds:
        # - ${PUBLIC_SUBNET_1}
        # - ${PUBLIC_SUBNET_2}
        # - ${PUBLIC_SUBNET_1}
        - ${PRIVATE_SUBNET_1}
        - ${PRIVATE_SUBNET_2}
        - ${PRIVATE_SUBNET_3}
